4.3. CÀI ĐẶT FRONTEND
4.3.1. Cài đặt quản lý trạng thái
Frontend sử dụng hai cách tiếp cận để quản lý trạng thái. TanStack Query phiên bản 5.90.16 quản lý trạng thái server như dữ liệu từ API. Zustand phiên bản 5.0.9 quản lý trạng thái client như thông tin người dùng đang đăng nhập và cài đặt giao diện.
TanStack Query tự động cache dữ liệu API, invalidate cache khi cần thiết, và xử lý các trạng thái loading, error, và success. Hook useQuery được sử dụng để lấy dữ liệu, hook useMutation để thực hiện các thao tác tạo, sửa, xóa.
Zustand store lưu thông tin user hiện tại, token xác thực, và các preference như theme hoặc sidebar state. Store được persist vào localStorage để giữ trạng thái khi refresh trang.
Lý do dùng hai công cụ là mỗi công cụ tối ưu cho mục đích riêng. TanStack Query giỏi xử lý dữ liệu async từ server với caching và refetching. Zustand đơn giản và nhẹ cho trạng thái đồng bộ phía client.
4.3.2. Cài đặt API client
API client được xây dựng trên Axios phiên bản 1.13.2 với cấu hình interceptor để tự động đính kèm JWT token vào mỗi request và xử lý refresh token khi access token hết hạn.
Request interceptor thêm header Authorization với format Bearer token vào mỗi request. Token được lấy từ Zustand store.
Response interceptor bắt lỗi 401 Unauthorized, tự động gọi API refresh token, lưu token mới, và retry request ban đầu. Nếu refresh thất bại, người dùng được chuyển về trang đăng nhập.
Lý do xử lý refresh token ở interceptor là người dùng không bị gián đoạn khi token hết hạn. Việc làm mới diễn ra ngầm và request tiếp tục như bình thường.
4.3.3. Cài đặt hệ thống routing
React Router DOM phiên bản 7.11.0 được sử dụng để điều hướng. Routes được chia thành public routes cho trang đăng nhập và protected routes cho các trang cần xác thực.
Component ProtectedRoute bọc các route cần xác thực, kiểm tra token và chuyển về trang đăng nhập nếu chưa đăng nhập. Component này cũng kiểm tra quyền và hiển thị trang 403 nếu không có quyền truy cập.
Các route chính bao gồm /auth/login cho đăng nhập, /dashboard cho trang chủ, /proposals cho danh sách đề tài, /proposals/:id cho chi tiết đề tài, /councils cho quản lý Hội đồng, /admin cho quản trị hệ thống, và nhiều route khác.
Lý do kiểm tra quyền ở route level là ngăn người dùng truy cập trang không được phép ngay từ đầu. Giao diện sạch sẽ hơn khi chỉ hiển thị những gì người dùng có quyền xem.
4.3.4. Cài đặt component UI cơ bản
Thư mục components/ui chứa các component giao diện cơ bản được xây dựng với Tailwind CSS phiên bản 4.1.18. Các component tuân theo design system nhất quán về màu sắc, kích thước, và spacing.
Component Button có các biến thể primary, secondary, danger, và ghost. Mỗi biến thể có màu sắc riêng và trạng thái hover, active, disabled được xử lý đầy đủ. Props bao gồm loading để hiển thị spinner khi đang xử lý.
Component Input hỗ trợ các loại text, email, password, number với validation tích hợp. Trạng thái error hiển thị viền đỏ và thông báo lỗi bên dưới.
Component Modal hiển thị dialog overlay với animation mở đóng mượt mà. Hỗ trợ đóng khi click bên ngoài hoặc nhấn Escape.
Component Table hiển thị dữ liệu dạng bảng với sorting khi click header, pagination ở footer, và loading skeleton khi đang fetch dữ liệu.
Lucide React phiên bản 0.562.0 cung cấp bộ icon nhất quán cho toàn bộ ứng dụng.
4.3.5. Cài đặt component nghiệp vụ
Thư mục components/proposals chứa các component liên quan đến đề tài bao gồm ProposalList hiển thị danh sách với filter, ProposalDetail hiển thị chi tiết một đề tài, ProposalForm cho việc tạo và sửa đề tài, và ProposalStatusBadge hiển thị trạng thái với màu sắc tương ứng.
Thư mục components/workflow chứa WorkflowTimeline hiển thị lịch sử trạng thái theo dạng timeline, WorkflowActions hiển thị các nút hành động được phép dựa trên trạng thái hiện tại và quyền của người dùng.
Thư mục components/evaluation chứa EvaluationForm cho thành viên Hội đồng điền phiếu đánh giá, EvaluationSummary tổng hợp kết quả đánh giá từ các thành viên.
Thư mục components/document-generation chứa giao diện chọn loại tài liệu cần tạo và hiển thị tiến trình tạo tài liệu.
4.3.6. Cài đặt layout và navigation
Component Layout định nghĩa bố cục chung với Header cố định ở trên, Sidebar bên trái, và vùng nội dung chính.
Component Header hiển thị logo, tên người dùng, dropdown menu với các tùy chọn xem profile, đổi mật khẩu, và đăng xuất. Badge thông báo hiển thị số lượng thông báo chưa đọc.
Component Sidebar hiển thị menu điều hướng theo vai trò người dùng. Giảng viên thấy các mục Đề tài của tôi, Tạo mới, Lịch sử. Quản lý Khoa thấy thêm mục Duyệt đề tài, Thống kê Khoa. Admin thấy đầy đủ các mục quản trị.
Sidebar có thể thu gọn để tăng không gian cho nội dung chính. Trạng thái thu gọn được lưu vào localStorage.
4.3.7. Cài đặt charts và dashboard
Recharts phiên bản 3.6.0 được sử dụng để vẽ biểu đồ trên trang Dashboard. Các loại biểu đồ bao gồm BarChart cho thống kê đề tài theo trạng thái, LineChart cho xu hướng theo thời gian, PieChart cho phân bố đề tài theo Khoa.
Component DashboardStats hiển thị các số liệu tổng quan như tổng số đề tài, số đề tài chờ duyệt, số đề tài quá hạn SLA, và tỷ lệ hoàn thành.
Component MorningCheck dành cho quản lý hiển thị danh sách đề tài cần xử lý trong ngày, sắp xếp theo độ ưu tiên và thời hạn SLA.
Dữ liệu dashboard được cache với staleTime dài hơn vì không cần cập nhật thường xuyên như dữ liệu chi tiết đề tài.
4.3.8. Cài đặt responsive design
Tailwind CSS cung cấp các breakpoint sm cho màn hình từ 640px, md cho 768px, lg cho 1024px, và xl cho 1280px. Các class responsive được sử dụng để điều chỉnh layout theo kích thước màn hình.
Trên desktop với màn hình rộng, Sidebar luôn hiển thị và bảng hiển thị đầy đủ cột. Trên tablet, Sidebar có thể thu gọn và một số cột ít quan trọng được ẩn. Trên mobile, Sidebar chuyển thành drawer overlay và bảng chuyển thành danh sách card.
Component useMediaQuery hook kiểm tra kích thước màn hình và cho phép các component điều chỉnh behavior tương ứng.
Lý do cần responsive là người dùng có thể kiểm tra trạng thái đề tài trên điện thoại khi không ở văn phòng. Trải nghiệm phải tốt trên mọi thiết bị.
