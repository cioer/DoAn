graph TB
    %% Use Case Diagram - 45 Use Cases
    %% H·ªá th·ªëng qlNCKH

    %% ========================================
    %% ACTORS
    %% ========================================

    GV["üë®‚Äçüè´ GI·∫¢NG VI√äN<br/>(PI / PROJECT_OWNER)"]
    QLK["üëî QU·∫¢N L√ù KHOA"]
    TKK["üìã TH∆Ø K√ù KHOA"]
    KHCN["üè¢ PH√íNG KHCN"]
    TKHD["üìù TH∆Ø K√ù H·ªòI ƒê·ªíNG"]
    TV["üë®‚Äç‚öñÔ∏è TH√ÄNH VI√äN H·ªòI ƒê·ªíNG"]
    BGH["üéì BAN GI√ÅM HI·ªÜU"]
    ADMIN["‚öôÔ∏è ADMIN"]

    %% ========================================
    %% EPIC 1: User Management
    %% ========================================

    subgraph Epic1["EPIC 1: USER MANAGEMENT"]
        UC1["UC-1.1: ƒêƒÉng nh·∫≠p h·ªá th·ªëng"]
        UC2["UC-1.2: Qu·∫£n l√Ω th√¥ng tin c√° nh√¢n"]
        UC3["UC-1.3: ƒê·ªïi m·∫≠t kh·∫©u"]
        UC4["UC-1.4: ADMIN qu·∫£n l√Ω ng∆∞·ªùi d√πng"]
        UC5["UC-1.5: ADMIN ph√¢n quy·ªÅn"]
    end

    %% ========================================
    %% EPIC 2: Proposal Management (PI)
    %% ========================================

    subgraph Epic2["EPIC 2: PROPOSAL MANAGEMENT"]
        UC6["UC-2.1: T·∫°o ƒë·ªÅ t√†i m·ªõi"]
        UC7["UC-2.2: Ch·ªçn bi·ªÉu m·∫´u template"]
        UC8["UC-2.3: Nh·∫≠p th√¥ng tin ƒë·ªÅ t√†i"]
        UC9["UC-2.4: Upload t√†i li·ªáu ƒë√≠nh k√®m"]
        UC10["UC-2.5: L∆∞u nh√°p ƒë·ªÅ t√†i"]
        UC11["UC-2.6: N·ªôp ƒë·ªÅ t√†i l√™n Khoa"]
        UC12["UC-2.7: Xem danh s√°ch ƒë·ªÅ t√†i c·ªßa m√¨nh"]
        UC13["UC-2.8: Xu·∫•t ƒë·ªÅ t√†i ra PDF"]
    end

    %% ========================================
    %% EPIC 3: Workflow & State Transitions
    %% ========================================

    subgraph Epic3["EPIC 3: WORKFLOW"]
        UC14["UC-3.1: Khoa duy·ªát ƒë·ªÅ t√†i"]
        UC15["UC-3.2: Khoa y√™u c·∫ßu ch·ªânh s·ª≠a"]
        UC16["UC-3.3: PI n·ªôp l·∫°i sau khi s·ª≠a"]
        UC17["UC-3.4: KHCN ph√¢n c√¥ng h·ªôi ƒë·ªìng"]
        UC18["UC-3.5: H·ªôi ƒë·ªìng x√©t duy·ªát"]
        UC19["UC-3.6: BGH ph√™ duy·ªát cu·ªëi c√πng"]
    end

    %% ========================================
    %% EPIC 4: SLA & Business Calendar
    %% ========================================

    subgraph Epic4["EPIC 4: SLA MANAGEMENT"]
        UC20["UC-4.1: T√≠nh to√°n SLA deadline"]
        UC21["UC-4.2: C·∫£nh b√°o s·∫Øp qu√° h·∫°n"]
        UC22["UC-4.3: ADMIN qu·∫£n l√Ω ng√†y ngh·ªâ"]
        UC23["UC-4.4: Pause SLA khi YC s·ª≠a"]
    end

    %% ========================================
    %% EPIC 5: Council & Evaluation
    %% ========================================

    subgraph Epic5["EPIC 5: COUNCIL & EVALUATION"]
        UC24["UC-5.1: KHCN t·∫°o h·ªôi ƒë·ªìng"]
        UC25["UC-5.2: Ph√¢n c√¥ng th√†nh vi√™n Hƒê"]
        UC26["UC-5.3: Th∆∞ k√Ω t·∫°o phi·∫øu ƒë√°nh gi√°"]
        UC27["UC-5.4: Th√†nh vi√™n n·ªôp ƒë√°nh gi√°"]
        UC28["UC-5.5: PI xem k·∫øt qu·∫£ ƒë√°nh gi√°"]
    end

    %% ========================================
    %% EPIC 6: Execution Phase
    %% ========================================

    subgraph Epic6["EPIC 6: EXECUTION PHASE"]
        UC29["UC-6.1: PI b·∫Øt ƒë·∫ßu th·ª±c hi·ªán"]
        UC30["UC-6.2: PI n·ªôp h·ªì s∆° nghi·ªám thu"]
        UC31["UC-6.3: Khoa nghi·ªám thu"]
        UC32["UC-6.4: Tr∆∞·ªùng nghi·ªám thu"]
        UC33["UC-6.5: Ho√†n t·∫•t b√†n giao"]
    end

    %% ========================================
    %% EPIC 7: Document Generation
    %% ========================================

    subgraph Epic7["EPIC 7: DOCUMENT GENERATION"]
        UC34["UC-7.1: ADMIN upload template DOCX"]
        UC35["UC-7.2: ADMIN k√≠ch ho·∫°t template"]
        UC36["UC-7.3: PI t·∫°o bi·ªÉu m·∫´u t·ª± ƒë·ªông"]
        UC37["UC-7.4: H·ªá th·ªëng sinh DOCX"]
        UC38["UC-7.5: Chuy·ªÉn ƒë·ªïi sang PDF"]
        UC39["UC-7.6: X√°c th·ª±c t√≠nh to√†n v·∫πn"]
    end

    %% ========================================
    %% EPIC 8: Bulk Operations & Reporting
    %% ========================================

    subgraph Epic8["EPIC 8: BULK OPERATIONS"]
        UC40["UC-8.1: KHCN g√°n holder h√†ng lo·∫°t"]
        UC41["UC-8.2: KHCN nh·∫Øc nh·ªü h√†ng lo·∫°t"]
        UC42["UC-8.3: KHCN xu·∫•t b√°o c√°o Excel"]
        UC43["UC-8.4: KHCN xem dashboard t·ªïng quan"]
    end

    %% ========================================
    %% EPIC 9: Exception Handling
    %% ========================================

    subgraph Epic9["EPIC 9: EXCEPTIONS"]
        UC44["UC-9.1: PI h·ªßy/r√∫t ƒë·ªÅ t√†i"]
        UC45["UC-9.2: KHCN/BGH t·ª´ ch·ªëi ƒë·ªÅ t√†i"]
        UC46["UC-9.3: KHCN t·∫°m d·ª´ng ƒë·ªÅ t√†i"]
        UC47["UC-9.4: KHCN ti·∫øp t·ª•c ƒë·ªÅ t√†i"]
    end

    %% ========================================
    %% EPIC 10: Data Import & Backup
    %% ========================================

    subgraph Epic10["EPIC 10: DATA MANAGEMENT"]
        UC48["UC-10.1: ADMIN import Excel"]
        UC49["UC-10.2: ADMIN backup database"]
        UC50["UC-10.3: ADMIN restore database"]
        UC51["UC-10.4: ADMIN x√°c minh tr·∫°ng th√°i"]
    end

    %% ========================================
    %% ACTOR-USE CASE RELATIONSHIPS
    %% ========================================

    %% GI·∫¢NG VI√äN
    GV --> UC1
    GV --> UC2
    GV --> UC3
    GV --> UC6
    GV --> UC7
    GV --> UC8
    GV --> UC9
    GV --> UC10
    GV --> UC11
    GV --> UC12
    GV --> UC13
    GV --> UC16
    GV --> UC28
    GV --> UC29
    GV --> UC30
    GV --> UC36
    GV --> UC44

    %% QU·∫¢N L√ù KHOA
    QLK --> UC1
    QLK --> UC2
    QLK --> UC3
    QLK --> UC14
    QLK --> UC15
    QLK --> UC31

    %% TH∆Ø K√ù KHOA
    TKK --> UC1
    TKK --> UC2
    TKK --> UC3
    TKK --> UC14
    TKK --> UC15

    %% PH√íNG KHCN
    KHCN --> UC1
    KHCN --> UC2
    KHCN --> UC3
    KHCN --> UC17
    KHCN --> UC24
    KHCN --> UC25
    KHCN --> UC32
    KHCN --> UC40
    KHCN --> UC41
    KHCN --> UC42
    KHCN --> UC43
    KHCN --> UC45
    KHCN --> UC46
    KHCN --> UC47

    %% TH∆Ø K√ù H·ªòI ƒê·ªíNG
    TKHD --> UC1
    TKHD --> UC2
    TKHD --> UC3
    TKHD --> UC18
    TKHD --> UC26

    %% TH√ÄNH VI√äN H·ªòI ƒê·ªíNG
    TV --> UC1
    TV --> UC2
    TV --> UC3
    TV --> UC18
    TV --> UC27

    %% BAN GI√ÅM HI·ªÜU
    BGH --> UC1
    BGH --> UC2
    BGH --> UC3
    BGH --> UC19
    BGH --> UC45

    %% ADMIN
    ADMIN --> UC1
    ADMIN --> UC2
    ADMIN --> UC3
    ADMIN --> UC4
    ADMIN --> UC5
    ADMIN --> UC22
    ADMIN --> UC34
    ADMIN --> UC35
    ADMIN --> UC48
    ADMIN --> UC49
    ADMIN --> UC50
    ADMIN --> UC51

    %% System interactions
    UC11 -.->|triggers| UC14
    UC16 -.->|triggers| UC14
    UC14 -.->|approved| UC17
    UC17 -.->|assigned| UC18
    UC18 -.->|approved| UC19
    UC19 -.->|approved| UC29
    UC30 -.->|triggers| UC31
    UC31 -.->|approved| UC32
    UC32 -.->|approved| UC33

    UC36 -.->|uses| UC37
    UC37 -.->|generates| UC38
    UC38 -.->|uses| UC39

    %% Styling
    classDef actorStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#000
    classDef ucStyle fill:#e8f5e9,stroke:#388e3c,stroke-width:2px,color:#000

    class GV,QLK,TKK,KHCN,TKHD,TV,BGH,ADMIN actorStyle
    class UC1,UC2,UC3,UC4,UC5,UC6,UC7,UC8,UC9,UC10,UC11,UC12,UC13,UC14,UC15 ucStyle
    class UC16,UC17,UC18,UC19,UC20,UC21,UC22,UC23,UC24,UC25,UC26,UC27,UC28,UC29,UC30 ucStyle
    class UC31,UC32,UC33,UC34,UC35,UC36,UC37,UC38,UC39,UC40,UC41,UC42,UC43,UC44,UC45 ucStyle
    class UC46,UC47,UC48,UC49,UC50,UC51 ucStyle
